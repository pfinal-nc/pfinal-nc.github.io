---
title: é€ è½®å­ å•æ–‡ä»¶ç®¡å¤šé¡¹ç›®éƒ¨ç½²ï¼ŒGit æœåŠ¡å™¨å…¨æå®š
date: 2025-11-05 10:00:00
tags:
  - å·¥å…·
  - PHP
  - éƒ¨ç½²
  - Git
  - SSH
description: ä¸€ä¸ªç±»ä¼¼ Adminer.php çš„å•æ–‡ä»¶ PHP ä»£ç éƒ¨ç½²å·¥å…·ï¼Œæ”¯æŒ Git + SSH éƒ¨ç½²ï¼Œç®€å•æ˜“ç”¨ï¼Œä¸€ä¸ªæ–‡ä»¶æå®šæ‰€æœ‰éƒ¨ç½²éœ€æ±‚ã€‚
author: PFinalå—ä¸
keywords: å•æ–‡ä»¶éƒ¨ç½²å·¥å…·, PHPéƒ¨ç½², Gitéƒ¨ç½², SSHéƒ¨ç½², è‡ªåŠ¨åŒ–éƒ¨ç½²
---
# é€ è½®å­ï¼šå•æ–‡ä»¶ç®¡å¤šé¡¹ç›®éƒ¨ç½²ï¼ŒGit / æœåŠ¡å™¨å…¨æå®š

åšé¡¹ç›®çš„æ—¶å€™,ç»å¸¸ä½¿ç”¨ *Adminer* æ¥ä¾¿æ·çš„æ“ä½œæ•°æ®åº“,ä¸€ä¸ª PHP æ–‡ä»¶æå®šä¸€åˆ‡,æ¯” phpMyAdmin è¦æ–¹ä¾¿å¾ˆå¤šã€‚ä»”ç»†çš„ç¿»äº†ä¸€ä¸‹ *Adminer* çš„æºç , å‘ç°å®ƒçš„æ¶æ„è®¾è®¡çœŸçš„ç²¾ç®€,äºæ˜¯æŠŠé¡¹ç›®éƒ¨ç½²ä¸Šçº¿çš„æµç¨‹,ä¹Ÿé€šè¿‡ç›¸åŒçš„æ€è·¯,åšäº†ä¸€ä¸ªç®€å•çš„å•æ–‡ä»¶ä»£ç éƒ¨ç½²å·¥å…·ã€‚æ•ˆæœå¦‚ä¸‹:

![](https://raw.githubusercontent.com/pfinal-nc/iGallery/master/blog/202511050901667.png)

## å·¥å…·ç‰¹æ€§

- ğŸš€ **å•æ–‡ä»¶éƒ¨ç½²** - ç±»ä¼¼ Adminerï¼Œä¸€ä¸ª PHP æ–‡ä»¶å³å¯è¿è¡Œ
- ğŸ” **ç”¨æˆ·è®¤è¯** - ç®€å•çš„ç”¨æˆ·åå¯†ç è®¤è¯ç³»ç»Ÿ
- ğŸ“¦ **å¤šé¡¹ç›®ç®¡ç†** - æ”¯æŒç®¡ç†å¤šä¸ªé¡¹ç›®
- ğŸ–¥ï¸ **æœåŠ¡å™¨ç®¡ç†** - æ”¯æŒå¤šä¸ª SSH æœåŠ¡å™¨é…ç½®
- ğŸ”„ **Git éƒ¨ç½²** - åŸºäº Git çš„ä»£ç æ‹‰å–å’Œéƒ¨ç½²
- ğŸ“ **éƒ¨ç½²å†å²** - å®Œæ•´çš„éƒ¨ç½²è®°å½•å’Œæ—¥å¿—æŸ¥çœ‹
- ğŸ”Œ **æ’ä»¶ç³»ç»Ÿ** - æ”¯æŒ Composerã€Artisan ç­‰æ’ä»¶
- ğŸ“Š **Web ç•Œé¢** - å‹å¥½çš„ Web ç®¡ç†ç•Œé¢

## å®‰è£…ä¸ä½¿ç”¨

### å¼€å‘æ¨¡å¼

```bash
# å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®
cd pfinal-deployer

# ä½¿ç”¨ PHP å†…ç½®æœåŠ¡å™¨è¿è¡Œ
php -S localhost:8090 deployer.php
```

è®¿é—® `http://localhost:8090`  
é»˜è®¤ç”¨æˆ·å: `admin`  
é»˜è®¤å¯†ç : `admin`

### ç”Ÿäº§æ¨¡å¼ï¼ˆå•æ–‡ä»¶ï¼‰

```bash
# ç¼–è¯‘æˆå•æ–‡ä»¶
php compile.php

# è¿è¡Œå•æ–‡ä»¶
php deployer-single.php
# æˆ–é…ç½®åˆ° Nginx/Apache
```
*ç¼–è¯‘æ•ˆæœå¦‚ä¸‹*

```shell
php compile.php
å¼€å§‹ç¼–è¯‘ï¼ˆä¼˜åŒ–æ¨¡å¼ï¼‰...
å¤„ç†: core/Logger.php
å¤„ç†: lang/zh.php
å¤„ç†: core/Database.php
å¤„ç†: core/SecureStorage.php
å¤„ç†: core/Validator.php
å¤„ç†: core/CSRF.php
å¤„ç†: core/SSHExecutor.php
å¤„ç†: core/GitDeployer.php
å¤„ç†: core/Auth.php
å¤„ç†: core/Deployer.php
å¤„ç†: drivers/SSHDriver.php
å¤„ç†: plugins/PluginInterface.php
å¤„ç†: plugins/ComposerPlugin.php
å¤„ç†: plugins/ArtisanPlugin.php
å¤„ç†: ui/css.php
å¤„ç†: ui/js.php
å¤„ç†è§†å›¾: login.php
å¤„ç†è§†å›¾: dashboard.php
å¤„ç†è§†å›¾: projects.php
å¤„ç†è§†å›¾: project_edit.php
å¤„ç†è§†å›¾: servers.php
å¤„ç†è§†å›¾: server_edit.php
å¤„ç†è§†å›¾: deployments.php
å¤„ç†è§†å›¾: change_password.php
å‹ç¼©ä»£ç ï¼ˆLogger.php é£æ ¼ï¼‰...
å‹ç¼©å‰: 191,638 bytes
å‹ç¼©å: 129,592 bytes
å‹ç¼©ç‡: 32.4%
å‹ç¼©å‰: 191,638 bytes
å‹ç¼©å: 129,592 bytes

ç¼–è¯‘å®Œæˆ: deployer-single.php
æ–‡ä»¶å¤§å°: 126.55 KB
å†™å…¥å­—èŠ‚æ•°: 129,592 bytes
```

*ç¼–è¯‘åçš„ä»£ç å¦‚ä¸‹:*

```php
<?php
error_reporting(E_ALL);ini_set('display_errors',1);ini_set('display_startup_errors',1);date_default_timezone_set('Asia/Shanghai');class Logger{private static $logFile=null;private static $logDir=null;public static function init($logDir=null){if($logDir===null){$logDir=__DIR__.'/storage/logs';}if(!is_dir($logDir)){@mkdir($logDir,0755,true);}self::$logDir=$logDir;self::$logFile=$logDir.'/deployer_'.date('Y-m-d').'.log';}public static function log($message,$level='INFO'){if(self::$logFile===null){self::init();}$timestamp=date('Y-m-d H:i:s');$logMessage="[{$timestamp}] [{$level}] {$message}".PHP_EOL;@file_put_contents(self::$logFile,$logMessage,FILE_APPEND);}public static function info($message){self::log($message,'INFO');}public static 

....

```

## ä½¿ç”¨æµç¨‹

1. **æ·»åŠ æœåŠ¡å™¨**
   - ç™»å½•ç³»ç»Ÿ
   - è¿›å…¥"æœåŠ¡å™¨"é¡µé¢
   - æ·»åŠ  SSH æœåŠ¡å™¨ä¿¡æ¯ï¼šæœåŠ¡å™¨åç§°ã€ä¸»æœºåœ°å€ã€ç«¯å£ã€ç”¨æˆ·åã€SSH å¯†é’¥
   - æµ‹è¯•è¿æ¥
![](https://raw.githubusercontent.com/pfinal-nc/iGallery/master/blog/202511051100175.png)

2. **æ·»åŠ é¡¹ç›®**
   - è¿›å…¥"é¡¹ç›®"é¡µé¢
   - ç‚¹å‡»"æ·»åŠ é¡¹ç›®"
   - å¡«å†™é¡¹ç›®ä¿¡æ¯ï¼šåç§°ã€Git ä»“åº“åœ°å€ã€åˆ†æ”¯ã€éƒ¨ç½²è·¯å¾„ã€é€‰æ‹©æœåŠ¡å™¨ã€éƒ¨ç½²å‰åè„šæœ¬
![](https://raw.githubusercontent.com/pfinal-nc/iGallery/master/blog/202511051103480.png)

3. **æ‰§è¡Œéƒ¨ç½²**
   - åœ¨é¡¹ç›®åˆ—è¡¨æˆ–ä»ªè¡¨æ¿ç‚¹å‡»"éƒ¨ç½²"æŒ‰é’®
   - ç³»ç»Ÿè‡ªåŠ¨è¿æ¥æœåŠ¡å™¨ã€æ‹‰å–ä»£ç ã€æ‰§è¡Œè„šæœ¬ã€è¿è¡Œæ’ä»¶ä»»åŠ¡ã€è®°å½•æ—¥å¿—
![](https://raw.githubusercontent.com/pfinal-nc/iGallery/master/blog/202511051104377.png)

4. **æŸ¥çœ‹éƒ¨ç½²å†å²**
   - åœ¨"éƒ¨ç½²å†å²"é¡µé¢æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€ã€æäº¤ä¿¡æ¯å’Œè¯¦ç»†æ—¥å¿—

## ç›®å½•ç»“æ„

```
pfinal-deployer/
â”œâ”€â”€ deployer.php              # ä¸»å…¥å£æ–‡ä»¶ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
â”œâ”€â”€ compile.php               # æ‰“åŒ…è„šæœ¬
â”œâ”€â”€ deployer-single.php      # ç¼–è¯‘åçš„å•æ–‡ä»¶
â”œâ”€â”€ core/                     # æ ¸å¿ƒç±»
â”‚   â”œâ”€â”€ Logger.php
â”‚   â”œâ”€â”€ Database.php
â”‚   â”œâ”€â”€ Auth.php
â”‚   â”œâ”€â”€ SSHExecutor.php
â”‚   â”œâ”€â”€ GitDeployer.php
â”‚   â”œâ”€â”€ Deployer.php
â”‚   â””â”€â”€ Router.php
â”œâ”€â”€ drivers/                  # é©±åŠ¨
â”‚   â””â”€â”€ SSHDriver.php
â”œâ”€â”€ plugins/                  # æ’ä»¶
â”‚   â”œâ”€â”€ PluginInterface.php
â”‚   â”œâ”€â”€ ComposerPlugin.php
â”‚   â””â”€â”€ ArtisanPlugin.php
â”œâ”€â”€ lang/                     # è¯­è¨€åŒ…
â”‚   â””â”€â”€ zh.php
â”œâ”€â”€ ui/                       # UI èµ„æº
â”‚   â”œâ”€â”€ css.php
â”‚   â”œâ”€â”€ js.php
â”‚   â””â”€â”€ views/               # è§†å›¾æ–‡ä»¶
â”‚       â”œâ”€â”€ login.php
â”‚       â”œâ”€â”€ dashboard.php
â”‚       â”œâ”€â”€ projects.php
â”‚       â”œâ”€â”€ project_edit.php
â”‚       â”œâ”€â”€ servers.php
â”‚       â”œâ”€â”€ server_edit.php
â”‚       â””â”€â”€ deployments.php
â””â”€â”€ storage/                  # å­˜å‚¨ç›®å½•
    â”œâ”€â”€ deployer.db          # SQLite æ•°æ®åº“
    â””â”€â”€ logs/                # æ—¥å¿—æ–‡ä»¶
```

## æ’ä»¶å¼€å‘

å®ç° PluginInterface æ¥å£å³å¯åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶ï¼š

```php
class MyPlugin implements PluginInterface {
    public function shouldRun($project) {
        // åˆ¤æ–­æ˜¯å¦åº”è¯¥è¿è¡Œæ­¤æ’ä»¶
        return true;
    }
    
    public function execute($sshExecutor, $project) {
        // æ‰§è¡Œæ’ä»¶é€»è¾‘
        $command = "cd {$project['deploy_path']} && your-command";
        return $sshExecutor->execute($command);
    }
}
```

æºç : [https://github.com/PFinal-tool/deployer](https://github.com/PFinal-tool/deployer)

