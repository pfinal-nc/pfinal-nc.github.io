import{_ as t,c as i,o as a,a6 as s}from"./chunks/framework.DFafSIgU.js";const y=JSON.parse(`{"title":"A Crawler Developer's Guide to Identifying Encryption Algorithms","description":"A practical guide for web crawler developers on how to identify common encryption, hashing, and encoding algorithms found in website JavaScript code.","frontmatter":{"title":"A Crawler Developer's Guide to Identifying Encryption Algorithms","date":"2023-09-05T22:10:20.000Z","tags":["python","crawler","security","reverse-engineering"],"description":"A practical guide for web crawler developers on how to identify common encryption, hashing, and encoding algorithms found in website JavaScript code.","author":"PFinal南丞","keywords":"crawler, encryption, decryption, reverse-engineering, javascript, cryptojs, aes, rsa, md5, sha, base64","head":[["link",{"rel":"alternate","hreflang":"en","href":"https://friday-go.icu/python/Common-Encryption-Decryption-Algorithm-Features-for-Crawlers.html"}],["link",{"rel":"alternate","hreflang":"zh-CN","href":"https://friday-go.icu/zh/python/Common-Encryption-Decryption-Algorithm-Features-for-Crawlers.html"}],["link",{"rel":"alternate","hreflang":"x-default","href":"https://friday-go.icu/python/Common-Encryption-Decryption-Algorithm-Features-for-Crawlers.html"}],["meta",{"name":"keywords","content":"crawler, encryption, decryption, reverse-engineering, javascript, cryptojs, aes, rsa, md5, sha, base64, PFinalClub, Golang, PHP, Python, 技术博客, Tech Blog"}]]},"headers":[],"relativePath":"python/Common-Encryption-Decryption-Algorithm-Features-for-Crawlers.md","filePath":"python/Common-Encryption-Decryption-Algorithm-Features-for-Crawlers.md","lastUpdated":1763718357000}`),n={name:"python/Common-Encryption-Decryption-Algorithm-Features-for-Crawlers.md"};function o(r,e,l,d,h,c){return a(),i("div",{"data-pagefind-body":!0,"data-pagefind-meta":"date:1693951820000"},e[0]||(e[0]=[s(`<h1 id="a-crawler-developer-s-guide-to-identifying-encryption-algorithms" tabindex="-1">A Crawler Developer&#39;s Guide to Identifying Encryption Algorithms <a class="header-anchor" href="#a-crawler-developer-s-guide-to-identifying-encryption-algorithms" aria-label="Permalink to &quot;A Crawler Developer&#39;s Guide to Identifying Encryption Algorithms&quot;">​</a></h1><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>When developing web crawlers, you will inevitably encounter websites that protect their data or API requests with encryption. A login password might be RSA encrypted, an API request might require an MD5-based signature, or the data returned from an API might be an AES-encrypted blob.</p><p>Before you can replicate this logic in Python, your first and most critical task is to <strong>identify</strong> which algorithm is being used. This guide provides a set of &quot;fingerprints&quot; and common features to help you quickly spot these algorithms in obfuscated or minified JavaScript code.</p><hr><h2 id="quick-identification-cheat-sheet" tabindex="-1">Quick Identification Cheat Sheet <a class="header-anchor" href="#quick-identification-cheat-sheet" aria-label="Permalink to &quot;Quick Identification Cheat Sheet&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Algorithm</th><th style="text-align:left;">Common JS Keywords / Libraries</th><th style="text-align:left;">Key Variables to Find</th><th style="text-align:left;">Tell-Tale Signs &amp; Output</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>AES</strong></td><td style="text-align:left;"><code>CryptoJS.AES</code>, <code>encrypt</code>, <code>decrypt</code></td><td style="text-align:left;"><code>key</code>, <code>iv</code>, <code>mode</code> (e.g., <code>CBC</code>), <code>padding</code> (e.g., <code>Pkcs7</code>)</td><td style="text-align:left;">Encrypted output is often Base64 encoded.</td></tr><tr><td style="text-align:left;"><strong>DES</strong></td><td style="text-align:left;"><code>CryptoJS.DES</code>, <code>CryptoJS.TripleDES</code></td><td style="text-align:left;"><code>key</code>, <code>iv</code>, <code>mode</code>, <code>padding</code></td><td style="text-align:left;">Similar to AES but less common now.</td></tr><tr><td style="text-align:left;"><strong>RSA</strong></td><td style="text-align:left;"><code>JSEncrypt</code>, <code>setPublicKey</code>, <code>encrypt</code></td><td style="text-align:left;">Public Key (Modulus <code>n</code>, Exponent <code>e</code>)</td><td style="text-align:left;">A very long hexadecimal string for the public key.</td></tr><tr><td style="text-align:left;"><strong>MD5</strong></td><td style="text-align:left;"><code>CryptoJS.MD5</code>, <code>hex_md5</code>, <code>md5()</code></td><td style="text-align:left;">(None, it&#39;s a hash)</td><td style="text-align:left;">A 32-character hexadecimal string.</td></tr><tr><td style="text-align:left;"><strong>SHA</strong></td><td style="text-align:left;"><code>CryptoJS.SHA1</code>, <code>CryptoJS.SHA256</code>, etc.</td><td style="text-align:left;">(None, it&#39;s a hash)</td><td style="text-align:left;">SHA1: 40 hex chars. SHA256: 64 hex chars.</td></tr><tr><td style="text-align:left;"><strong>Base64</strong></td><td style="text-align:left;"><code>btoa()</code>, <code>atob()</code></td><td style="text-align:left;">(None, it&#39;s encoding)</td><td style="text-align:left;">Output uses <code>A-Z</code>, <code>a-z</code>, <code>0-9</code>, <code>+</code>, <code>/</code> and may have <code>=</code> padding.</td></tr></tbody></table><hr><h2 id="_1-symmetric-encryption-aes-des" tabindex="-1">1. Symmetric Encryption: AES &amp; DES <a class="header-anchor" href="#_1-symmetric-encryption-aes-des" aria-label="Permalink to &quot;1. Symmetric Encryption: AES &amp; DES&quot;">​</a></h2><p>In symmetric encryption, the same key is used for both encryption and decryption. <code>CryptoJS</code> is by far the most common library for this in web development.</p><h3 id="how-to-identify-aes-des" tabindex="-1">How to Identify AES/DES <a class="header-anchor" href="#how-to-identify-aes-des" aria-label="Permalink to &quot;How to Identify AES/DES&quot;">​</a></h3><p>Look for these patterns in the JavaScript code:</p><ol><li><p><strong>Library Keywords</strong>: The most obvious sign is the use of the <code>CryptoJS</code> library. Search for:</p><ul><li><code>CryptoJS.AES.encrypt(...)</code></li><li><code>CryptoJS.AES.decrypt(...)</code></li><li><code>CryptoJS.DES.encrypt(...)</code></li><li><code>CryptoJS.TripleDES.encrypt(...)</code></li></ul></li><li><p><strong>Configuration Objects</strong>: Encryption calls are almost always accompanied by a configuration object that specifies the mode, padding, and initialization vector (IV).</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// A typical CryptoJS AES encryption call</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> encrypted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CryptoJS.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(plainText, key, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iv: iv,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mode: CryptoJS.mode.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CBC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &lt;-- Characteristic Mode</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    padding: CryptoJS.pad.Pkcs7    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &lt;-- Characteristic Padding</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li><li><p><strong>Key Variables</strong>:</p><ul><li><strong><code>key</code></strong>: The secret key. This is what you need most. It might be hardcoded, derived from other data, or fetched from an API.</li><li><strong><code>iv</code></strong>: The initialization vector. It&#39;s often a fixed string or derived similarly to the key.</li><li><strong><code>mode</code></strong>: The block cipher mode of operation. Common values are <code>CryptoJS.mode.CBC</code> and <code>CryptoJS.mode.ECB</code>.</li><li><strong><code>padding</code></strong>: The padding scheme. Common values are <code>CryptoJS.pad.Pkcs7</code> and <code>CryptoJS.pad.AnsiX923</code>.</li></ul></li></ol><h3 id="what-to-do-after-identification" tabindex="-1">What to Do After Identification <a class="header-anchor" href="#what-to-do-after-identification" aria-label="Permalink to &quot;What to Do After Identification&quot;">​</a></h3><p>Once you&#39;ve identified an AES/DES implementation, your goal is to find the <strong>key</strong>, <strong>IV</strong>, <strong>mode</strong>, and <strong>padding</strong>. With these, you can replicate the logic in Python using a library like <code>pycryptodome</code>.</p><hr><h2 id="_2-asymmetric-encryption-rsa" tabindex="-1">2. Asymmetric Encryption: RSA <a class="header-anchor" href="#_2-asymmetric-encryption-rsa" aria-label="Permalink to &quot;2. Asymmetric Encryption: RSA&quot;">​</a></h2><p>RSA is used when the client needs to encrypt data that only the server can decrypt (e.g., passwords during login). The client uses a public key to encrypt, and the server uses a private key to decrypt.</p><h3 id="how-to-identify-rsa" tabindex="-1">How to Identify RSA <a class="header-anchor" href="#how-to-identify-rsa" aria-label="Permalink to &quot;How to Identify RSA&quot;">​</a></h3><ol><li><p><strong>Library Keywords</strong>: <code>JSEncrypt</code> is a very popular library for RSA in the frontend.</p><ul><li><code>new JSEncrypt()</code></li><li><code>.setPublicKey(...)</code> or <code>.setPrivateKey(...)</code></li><li><code>.encrypt(...)</code> or <code>.decrypt(...)</code></li></ul></li><li><p><strong>Key Components</strong>: RSA relies on a public key, which consists of a modulus (n) and a public exponent (e). In JavaScript, you&#39;ll often find these as very long hexadecimal strings.</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// A typical JSEncrypt usage pattern</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> encrypt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> JSEncrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// The public key is often a long hex string, or fetched from an API</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> publicKey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC... (long string) ...AQAB&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">encrypt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setPublicKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(publicKey);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> encrypted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> encrypt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(password);</span></span></code></pre></div></li><li><p><strong>Characteristic Variables</strong>: Look for variables named <code>modulus</code>, <code>exponent</code>, <code>publicKey</code>, or <code>privateKey</code>.</p></li></ol><h3 id="what-to-do-after-identification-1" tabindex="-1">What to Do After Identification <a class="header-anchor" href="#what-to-do-after-identification-1" aria-label="Permalink to &quot;What to Do After Identification&quot;">​</a></h3><p>Your goal is to extract the <strong>public key</strong> (specifically the modulus and exponent). Once you have it, you can use Python&#39;s <code>rsa</code> or <code>pycryptodome</code> library to perform the same encryption.</p><hr><h2 id="_3-hashing-algorithms-md5-sha" tabindex="-1">3. Hashing Algorithms: MD5 &amp; SHA <a class="header-anchor" href="#_3-hashing-algorithms-md5-sha" aria-label="Permalink to &quot;3. Hashing Algorithms: MD5 &amp; SHA&quot;">​</a></h2><p>Hashes are one-way functions used to create a fixed-size &quot;fingerprint&quot; of data. They are commonly used for generating request signatures, not for encrypting data that needs to be recovered.</p><h3 id="how-to-identify-md5-sha" tabindex="-1">How to Identify MD5/SHA <a class="header-anchor" href="#how-to-identify-md5-sha" aria-label="Permalink to &quot;How to Identify MD5/SHA&quot;">​</a></h3><ol><li><p><strong>Library Keywords</strong>: Again, <code>CryptoJS</code> is common.</p><ul><li><code>CryptoJS.MD5(...)</code></li><li><code>CryptoJS.SHA1(...)</code>, <code>CryptoJS.SHA256(...)</code></li><li>Sometimes you&#39;ll see custom or older functions like <code>hex_md5()</code> or <code>sha1()</code>.</li></ul></li><li><p><strong>Output Length</strong>: The length of the output is a dead giveaway.</p><ul><li><strong>MD5</strong>: Produces a 32-character hexadecimal string.</li><li><strong>SHA-1</strong>: Produces a 40-character hexadecimal string.</li><li><strong>SHA-256</strong>: Produces a 64-character hexadecimal string.</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Example of generating a signature</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timestamp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;some-data&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> timestamp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sign </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CryptoJS.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MD5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;my-secret-salt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// sign will be a 32-character hex string</span></span></code></pre></div></li></ol><h3 id="what-to-do-after-identification-2" tabindex="-1">What to Do After Identification <a class="header-anchor" href="#what-to-do-after-identification-2" aria-label="Permalink to &quot;What to Do After Identification&quot;">​</a></h3><p>For hashes, you don&#39;t need a &quot;key&quot; for decryption. Instead, you need to identify the <strong>exact input data</strong> being hashed. This often includes a combination of request parameters, a timestamp, and sometimes a hardcoded &quot;salt&quot; or secret string. Your task is to find all these components and replicate the hashing process in the same order.</p><hr><h2 id="_4-encoding-base64" tabindex="-1">4. Encoding: Base64 <a class="header-anchor" href="#_4-encoding-base64" aria-label="Permalink to &quot;4. Encoding: Base64&quot;">​</a></h2><p>Base64 is an <strong>encoding</strong> scheme, not an encryption algorithm. It&#39;s used to represent binary data in an ASCII string format. It&#39;s often used to encode the output of an encryption algorithm, so you&#39;ll frequently see it used alongside AES or RSA.</p><h3 id="how-to-identify-base64" tabindex="-1">How to Identify Base64 <a class="header-anchor" href="#how-to-identify-base64" aria-label="Permalink to &quot;How to Identify Base64&quot;">​</a></h3><ol><li><p><strong>Native JavaScript Functions</strong>:</p><ul><li><code>btoa()</code>: Encodes a string to Base64.</li><li><code>atob()</code>: Decodes a Base64 string.</li></ul></li><li><p><strong>Characteristic Character Set</strong>: The output string will only contain uppercase letters (<code>A-Z</code>), lowercase letters (<code>a-z</code>), numbers (<code>0-9</code>), and the <code>+</code> and <code>/</code> symbols. It may also be padded at the end with one or two <code>=</code> characters.</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// A common pattern: encrypt and then Base64 encode</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> encrypted </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CryptoJS.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data, key, config);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> finalOutput </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> encrypted.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CryptoJS.enc.Base64); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// or sometimes just .toString()</span></span></code></pre></div></li></ol><h3 id="what-to-do-after-identification-3" tabindex="-1">What to Do After Identification <a class="header-anchor" href="#what-to-do-after-identification-3" aria-label="Permalink to &quot;What to Do After Identification&quot;">​</a></h3><p>If you see Base64, it&#39;s usually the final step in an encryption chain. When replicating in Python, remember to perform the same Base64 encoding/decoding step after you&#39;ve handled the core encryption/decryption. Python&#39;s <code>base64</code> standard library is perfect for this.</p><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>Identifying the encryption or hashing algorithm is the first and most important step in reverse-engineering a website&#39;s data protection measures. By looking for characteristic library calls, function names, constants, and output formats, you can quickly narrow down the possibilities. Once the algorithm is identified, your focus can shift to finding the necessary inputs—keys, IVs, and data—to replicate the process in your own crawler.</p>`,38)]))}const g=t(n,[["render",o]]);export{y as __pageData,g as default};
